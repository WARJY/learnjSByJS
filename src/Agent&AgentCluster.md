# 代理
- 【代理】是ecma262规范定义的一种抽象概念

- 【代理】由一个ecmascript【执行上下文堆栈】，一个正在执行的【执行上下文】，一组【任务队列的和集合】，一个【代理记录】，一个【执行线程】组成

- 一个【执行线程】可以执行多个【代理】中的任务，但一个【代理】只能由一个【执行线程】执行

# 代理记录
- 【代理记录】包含实现代理所需的多种属性
    - @field [[LittleEndian]] 该代理是否低位优先

    - @field [[CanBlock]]     该代理代理是否可以被阻塞

    - @field [[Signifier]]    该代理在一个【代理集群】中的唯一标识符

    - @field [[IsLockFree1]]  一字节的原子操作是否有锁

    - @field [[IsLockFree2]]  二字节的原子操作是否有锁

# 代理集群
- 【代理集群】是ecma262规范定义的一种抽象概念

- 【代理集群】是一些互相共享内存的【代理】的集合

-  每个【代理】必须存在于一个【代理集群】中

- 【代理集群】需要实现代理间互相通信的手段

# 浏览器实现
- 【浏览器】可以被视为一个【代理集群】

    - 【浏览器】（代理集群）是多个【tab页】（代理）的集合
    
    - 多个【tab页】之间共享浏览器主进程的内存

- 【浏览器】中的每个【tab页】可以被视为一个【代理】

    - 每个【tab页】拥有各自的进程，维护自己的执行环境

    - 每个【tab页】拥有各自的【执行上下文堆栈】，【执行上下文】

    - 每个【tab页】拥有各自的【任务队列的集合】

        - 【MacroQueue】维护js宏任务队列

        - 【MicroQueue】维护js微任务队列

    - 每个【tab页】共享一个浏览器主进程的【JSCORE线程】作为他们的【执行线程】

- 【浏览器】中的每个【tab页】维护各自的【执行上下文堆栈】和【任务队列】

    - 当发现【异步任务】就交给【timeOut】，【Promise】或【Http】等其他线程处理
    
    - 执行完毕后将结果推入【tab页】的任务队列中等待执行
